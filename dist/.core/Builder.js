const echoHandler=require("echo-handler"),fs=require("fs");module.exports=function(e){const r=echoHandler.configure({factoryOverride:`${e.root}/.core/i18n/${e.i18n}.buildMessages.json`,logger:e.logger}),o=(o,s,t)=>{if(o){const a=`${s.toLowerCase()}s`;o.forEach(o=>{const i=s.match(/[A-Za-z]+$/),n=o.replace(/\.js$/,"");if(c(n,s)){const r=require(`${e.root}/api/${a}/${n}`),o=n.replace(i?i[0]:"","");t(r,o)}else r.log("invalidType",o,a)})}},c=(e,r)=>e.match(`${r.replace(/^[A-Za-z]+\//,"")}$`);this.build=((c,s)=>{try{const t=`${c.toLowerCase()}s`,a=`${e.root}/api/${t}/`;fs.existsSync(a)?(o(fs.readdirSync(a),c,s),r.log("success",c.match(/[A-Za-z0-9]+$/))):r.throw("invalidDirectory",t)}catch(e){r.throw("buildFailed",c,e.stack)}return s})};